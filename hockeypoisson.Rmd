---
title: "Hockey Poisson"
author: "Ian Thorpe"
date: "4/4/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(tidyverse)
```


```{r}
hockey_data <- read.csv("~/DSCI478-Final/hockeydata.csv")
hockey_data %>%
  rename(away_goals = G) %>%
  rename(home_goals = G.1) %>%
  select(-c(X, Att., LOG, Notes)) %>%
  na.omit() -> hockey_data

write.csv(hockey_data, "hockeydata.csv")
  
```

```{r}
pois_prob = function(home_team, away_team) {
  hockey_data %>%
    filter(Visitor == away_team) %>%
    summarise(avg_gf_visit = mean(away_goals, na.rm = T),
              avg_ga_visit = mean(home_goals, na.rm = T)) -> away_data
  
  hockey_data %>%
    filter(Home == home_team) %>%
    summarise(avg_gf_home = mean(home_goals, na.rm = T),
              avg_ga_home = mean(away_goals, na.rm = T)) -> home_data
  
  
  
  avg_gf_home_league <- mean(hockey_data$home_goals, na.rm = T)
  avg_gf_away_league <- mean(hockey_data$away_goals, na.rm = T)
  
  home_attack <- home_data$avg_gf_home/avg_gf_home_league
  away_attack <- away_data$avg_gf_visit/avg_gf_away_league
  
  home_defense <- home_data$avg_ga_home/avg_gf_away_league
  away_defense <- away_data$avg_ga_visit/avg_gf_home_league
  
  home_exp_gf <- round(home_attack * away_defense * avg_gf_home_league, 2)
  away_exp_gf <- round(away_attack * home_defense * avg_gf_away_league, 2)
  
  cat(home_team, ": ", home_exp_gf, " ", away_team, ": ", away_exp_gf)
  
  
}


pois_prob("Colorado Avalanche", "Colorado Avalanche")
```


